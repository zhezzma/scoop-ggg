{
    "version": "1.0.0-preview.8",
    "description": "An interactive shell to work with AI-powered assistance providers",
    "homepage": "https://github.com/PowerShell/AIShell",
    "license": "MIT",
    "architecture": {
        "64bit": {
            "url": "https://github.com/PowerShell/AIShell/releases/download/v1.0.0-preview.8/AIShell-1.0.0-preview.8-win-x64.zip",
            "hash": "83e80f047a908e2c19378ddc91b125687271c0f05dbe313ddccc48d85a07ca15"
        }
    },
    "bin": "aish.exe",
    "persist": [
        ".aish"
    ],
    "pre_install": [
        "# 创建符号链接将用户目录的 .aish 指向 scoop 持久化目录",
        "$userAishPath = Join-Path $env:USERPROFILE '.aish'",
        "$persistPath = Join-Path $dir '.aish'",
        "if (Test-Path $userAishPath) {",
        "    if (!(Get-Item $userAishPath).LinkType) {",
        "        Move-Item $userAishPath \"${userAishPath}.backup\" -Force",
        "        Write-Host \"Existing .aish directory backed up to ${userAishPath}.backup\" -ForegroundColor Yellow",
        "    }",
        "}",
        "if (!(Test-Path $persistPath)) {",
        "    New-Item -ItemType Directory -Path $persistPath -Force | Out-Null",
        "}",
        "if (!(Test-Path $userAishPath)) {",
        "    New-Item -ItemType SymbolicLink -Path $userAishPath -Target $persistPath -Force | Out-Null",
        "}"
    ],
    "post_install": "Install-PSResource -Name AIShell -Repository PSGallery -Prerelease -TrustRepository -ErrorAction Stop -WarningAction SilentlyContinue",
    "uninstall": [
        "$userAishPath = Join-Path $env:USERPROFILE '.aish'",
        "if ((Test-Path $userAishPath) -and (Get-Item $userAishPath).LinkType) {",
        "    Remove-Item $userAishPath -Force",
        "}"
    ],
    "checkver": {
        "url": "https://api.github.com/repos/PowerShell/AIShell/releases",
        "jsonpath": "$.[?(@.tag_name =~ /v?([\\d.]+(-preview\\.[\\d]+)?)$/)].tag_name",
        "regex": "(?:v|V)?([\\d.]+(-preview\\.[\\d]+)?)"
    },
    "notes": [
        "This is a preview version of AIShell. This version of AIShell module depends on PSReadLine '2.4.3-beta3' or higher",
        "You can get the v2.4.3-beta3 version of the PSReadLine module from PowerShell Gallery. To install it, run:",
        "Install-Module -Name PackageManagement -Force -MinimumVersion 1.4.7 -Scope CurrentUser  -AllowClobber",
        "Install-Module -Name Microsoft.PowerShell.PSResourceGet -Force -Scope CurrentUser",
        "Install-PSResource -Name PSReadLine -Prerelease -TrustRepository"
    ],
    "autoupdate": {
        "architecture": {
            "64bit": {
                "url": "https://github.com/PowerShell/AIShell/releases/download/v$version/AIShell-$version-win-x64.zip"
            }
        }
    }
}
